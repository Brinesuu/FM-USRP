C51 COMPILER V9.60.0.0   TIMER                                                             04/10/2024 12:13:05 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE TIMER
OBJECT MODULE PLACED IN timer.OBJ
COMPILER INVOKED BY: D:\20217972\C51\BIN\C51.EXE timer.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          /**********************************
   2          ×÷Õß£ºµ¥Æ¬»ú¾ãÀÖ²¿
   3          ÍøÕ¾£ºhttps://www.mcuclub.cn/
   4          **********************************/
   5          
   6          
   7          /**********************************
   8          °üº¬Í·ÎÄ¼þ
   9          **********************************/
  10          #include "timer.h"
  11          
  12          
  13          /**********************************
  14          ±äÁ¿¶¨Òå
  15          **********************************/
  16          bit flag_timer_begin = 0;               //¼ÆÊ±¿ªÊ¼±êÖ¾Î»
  17          bit flag_1s = 0;                        //¶¨Ê±1sÍê³É±êÖ¾Î»
  18          
  19          
  20          /**********************************
  21          º¯Êý¶¨Òå
  22          **********************************/
  23          /****
  24          *******¶¨Ê±Æ÷0³õÊ¹»¯º¯Êý
  25          *****/
  26          void Timer0_Init(void)
  27          {
  28   1        TMOD &= 0xF0;                         //ÇåÁã T0 µÄ¿ØÖÆÎ»
  29   1        TMOD |= 0x01;                         //ÅäÖÃ T0 ÎªÄ£Ê½ 1
  30   1        TH0 = (65535-9216)/256;               //ÅäÖÃ T0 ÖØÔØÖµ
  31   1        TL0 = (65535-9216)%256;               //³õÖµµÈÓÚÖØÔØÖµ
  32   1      
  33   1        TR0 = 1;                              //Æô¶¯ T0
  34   1        ET0 = 1;                              //Æô¶¯ T0 ÖÐ¶Ï
  35   1        EA = 1;                               //´ò¿ª×ÜÖÐ¶Ï
  36   1      }
  37          
  38          /****
  39          *******T0¼ÆÊ±ÖÐ¶Ïº¯Êý
  40          
  41            1sµÄ¶¨Ê±´ÎÊý= 1/(12/11059200)=921600,16Î»¼ÆÊýÆ÷×î´ó¿É¼ÆÊý65536´Î£¬ËùÒÔÍ¨³£¶¨Ê±msÎªµ¥Î»£¬±ÈÈç¶¨Ê±10ms£¬ÔòÑ
             -­»·100´ÎÎª1s£¬Ôò¼ÆÊý´ÎÊýÎª921600/100=9216£¬Ôò³õÖµÎª
  42            TH0 = (65535-9216)/256;  //ÖØÐÂ¸³³õÖµ
  43            TL0 = (65535-9216)%256;
  44          *****/
  45          void Timer0_Handler(void) interrupt 1    //0£ºÍâ²¿ÖÐ¶Ï1µÄÖÐ¶ÏºÅ£» 1£º¶¨Ê±Æ÷0µÄÖÐ¶ÏºÅ£» 2 Íâ²¿ÖÐ¶Ï2µÄÖÐ¶ÏºÅ
             -£» 3£ºÎª¶¨Ê±Æ÷1µÄÖÐ¶ÏºÅ£» 4 ´®¿ÚÖÐ¶ÏµÄÖÐ¶ÏºÅ£»
  46          {
  47   1        static uint timer0_count;
  48   1      
  49   1        TH0 = (65535-9216)/256;               //ÖØÐÂ¸³³õÖµ
  50   1        TL0 = (65535-9216)%256;
  51   1      
  52   1        if(flag_timer_begin == 1)             //¿ªÊ¼¼ÆÊ±
  53   1        {
C51 COMPILER V9.60.0.0   TIMER                                                             04/10/2024 12:13:05 PAGE 2   

  54   2          timer0_count ++;
  55   2          if(timer0_count >= 100)             //¶¨Ê±1s
  56   2          {
  57   3            timer0_count = 0;
  58   3            flag_1s = 1;
  59   3          }
  60   2        }
  61   1        else
  62   1        {
  63   2          timer0_count = 0;
  64   2          flag_1s = 0;
  65   2        }
  66   1      }
  67          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     72    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      2    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
